var URI;var URIQuery;(function(){function e(e,t){var n=/^(.*)\//;if(e.authority&&!e.path){return"/"+t}else{return e.getPath().match(n)[0]+t}}function n(e){if(!e){return""}var n=e.replace(/\/\.\//g,"/");n=n.replace(/\/\.$/,"/");while(n.match(t)){n=n.replace(t,"/")}n=n.replace(/\/([^\/]*)\/\.\.$/,"/");while(n.match(/\/\.\.\//)){n=n.replace(/\/\.\.\//,"/")}return n}function r(e){var t=[];for(var n in e){if(e.hasOwnProperty(n)){t.push(n)}}return t.sort()}function i(e){return e}function s(e){return e}var t=/\/((?!\.\.\/)[^\/]*)\/\.\.\//;URI=function(e){if(!e){e=""}var t=/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/;var n=e.match(t);var r=n[1]||null;var i=n[2]||null;var s=n[3]||null;var o=n[4]||null;var u=n[5]||null;this.getScheme=function(){return r};this.setScheme=function(e){r=e};this.getAuthority=function(){return i};this.setAuthority=function(e){i=e};this.getPath=function(){return s};this.setPath=function(e){s=e};this.getQuery=function(){return o};this.setQuery=function(e){o=e};this.getFragment=function(){return u};this.setFragment=function(e){u=e}};URI.prototype.toString=function(){var e="";if(this.getScheme()){e+=this.getScheme()+":"}if(this.getAuthority()){e+="//"+this.getAuthority()}if(this.getPath()){e+=this.getPath()}if(this.getQuery()){e+="?"+this.getQuery()}if(this.getFragment()){e+="#"+this.getFragment()}return e};URI.prototype.resolve=function(t){var r=new URI;if(this.getScheme()){r.setScheme(this.getScheme());r.setAuthority(this.getAuthority());r.setPath(n(this.getPath()));r.setQuery(this.getQuery())}else{if(this.getAuthority()){r.setAuthority(this.getAuthority());r.setPath(n(this.getPath()));r.setQuery(this.getQuery())}else{if(!this.getPath()){r.setPath(t.getPath());if(this.getQuery()){r.setQuery(this.getQuery())}else{r.setQuery(t.getQuery())}}else{if(this.getPath().charAt(0)==="/"){r.setPath(n(this.getPath()))}else{r.setPath(e(t,this.getPath()));r.setPath(n(r.getPath()))}r.setQuery(this.getQuery())}r.setAuthority(t.getAuthority())}r.setScheme(t.getScheme())}r.setFragment(this.getFragment());return r};URI.prototype.parseQuery=function(){return URIQuery.fromString(this.getQuery(),this.querySeparator)};URIQuery=function(){this.params={};this.separator="&"};URIQuery.fromString=function(e,t){var n=new URIQuery;if(t){n.separator=t}n.addStringParams(e);return n};URIQuery.prototype.addStringParams=function(e){var t=e.split(this.separator);var n,r,i;for(var o=0;o<t.length;o++){n=t[o].split("=",2);r=s(n[0].replace(/\+/g," "));i=s(n[1].replace(/\+/g," "));if(!this.params.hasOwnProperty(r)){this.params[r]=[]}this.params[r].push(i)}};URIQuery.prototype.getParam=function(e){if(this.params.hasOwnProperty(e)){return this.params[e][0]}return null};URIQuery.prototype.toString=function(){var e=[];var t=r(this.params);var n,i;for(n=0;n<t.length;n++){for(i=0;i<this.params[t[n]].length;i++){e.push(t[n].replace(/ /g,"+")+"="+this.params[t[n]][i].replace(/ /g,"+"))}}return e.join(this.separator)}})()
